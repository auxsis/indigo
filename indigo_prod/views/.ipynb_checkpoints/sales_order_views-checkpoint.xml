<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<data>

		<record id="view_order_form_field_edit" model="ir.ui.view">
			<field name="name">sale.order.form.field.edit</field>
			<field name="model">sale.order</field>
			<field name="inherit_id" ref="sale.view_order_form"/>
			<field name="arch" type="xml">
				<xpath expr="//field[@name='payment_term_id']" position="after">
					<field name="allow_edit_readonly" invisible="1" />
				</xpath>
				<xpath expr="//field[@name='partner_id']" position="attributes">
					<attribute name="attrs">{'readonly': [('allow_edit_readonly', '=', False)]}</attribute>
				</xpath>
				<xpath expr="//field[@name='order_line']/tree/field[@name='price_unit']" position="attributes">
					<attribute name="attrs">{'readonly': [('parent.allow_edit_readonly', '=', False)]}</attribute>
				</xpath>
				<xpath expr="//field[@name='client_order_ref']" position="before">
					<field name="invoice_type" />
				</xpath>
				<xpath expr="//field[@name='payment_term_id']" position="before">
					<field name="legacy_number" />
				</xpath>
				<xpath expr="//field[@name='confirmation_date']" position="attributes">
					<attribute name="attrs">{}</attribute>
				</xpath>
				<xpath expr="//field[@name='partner_shipping_id']" position="after">
					<field name="print_count" readonly="1"/>
				</xpath>
			</field>
		</record>

		<record id="indigo_sale_order_form" model="ir.ui.view">
			<field name="name">Sales Order</field>
			<field name="model">sale.order</field>
			<field name="inherit_id" ref="sale.view_order_form"/>
			<field name="arch" type="xml">
				<xpath expr="//field[@name='order_line']/tree/field[@name='product_id']" position="after">
					<field name="product_model"/>
				</xpath>
			</field>
		</record>

		<!-- LEGACY NUMBER -->
		<record id="view_order_tree_extend" model="ir.ui.view">
			<field name="name">sale.order.tree.</field>
			<field name="model">sale.order</field>
			<field name="inherit_id" ref="sale.view_order_tree"/>
			<field name="arch" type="xml">
				<xpath expr="//field[@name='name']" position="after">
					<field name="legacy_number"/>
				</xpath>
			</field>
		</record>

		<!-- LEGACY NUMBER -->
		<record id="view_quotation_tree_extend" model="ir.ui.view">
			<field name="name">sale.order.tree.</field>
			<field name="model">sale.order</field>
			<field name="inherit_id" ref="sale.view_quotation_tree"/>
			<field name="arch" type="xml">
				<xpath expr="//field[@name='name']" position="after">
					<field name="legacy_number"/>
				</xpath>
			</field>
		</record>

		<!-- DELIVERY METHOD -->
		<record id="view_order_form_with_carrier_extend" model="ir.ui.view">
			<field name="name">Sales Order</field>
			<field name="model">sale.order</field>
			<field name="inherit_id" ref="delivery.view_order_form_with_carrier"/>
			<field name="arch" type="xml">
				<xpath expr="//field[@name='carrier_id']" position="attributes">
					<attribute name="attrs">{'readonly':[('state','not in',('draft','sent'))], 'required':[('state','in',('draft','sent'))]}</attribute>
				</xpath>
			</field>
		</record>
        
        <!-- PRODUCT AND SALES -->
        <record id="action_product_sale_order_list" model="ir.actions.act_window">
            <field name="name">Sales Order</field>
            <field name="res_model">sale.order</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('state', 'in', ['sale', 'done'])]</field>
        </record>

	</data>
</odoo>

